<!-- Created with Jaspersoft Studio version 7.0.3.final using JasperReports Library version 7.0.3-41034ca841d452f3305ba55b9042260aaa1ab5dd  -->
<jasperReport name="InformeMatriculas" language="java" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="a6076d92-6c8d-4c53-b7fb-0db7154d2a44">
	<parameter name="ID_CURSO" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[null]]></defaultValueExpression>
	</parameter>
	<query language="sql"><![CDATA[SELECT 
            u.id_usuario,
            u.nombre AS nombre_usuario,
            u.apellido AS apellido_usuario,
            u.email,
            u.tipo_usuario,
            c.id_curso,
            c.nombre_curso,
            a.nFaltas,
            a.nota
        FROM ASISTENCIA a
        INNER JOIN USUARIO u ON a.id_usuario = u.id_usuario
        INNER JOIN CURSO c ON a.id_curso = c.id_curso
        WHERE ($P{ID_CURSO} IS NULL OR c.id_curso = $P{ID_CURSO})
        ORDER BY c.nombre_curso, u.apellido, u.nombre]]></query>
	<field name="id_usuario" class="java.lang.Integer"/>
	<field name="nombre_usuario" class="java.lang.String"/>
	<field name="apellido_usuario" class="java.lang.String"/>
	<field name="email" class="java.lang.String"/>
	<field name="tipo_usuario" class="java.lang.String"/>
	<field name="id_curso" class="java.lang.Integer"/>
	<field name="nombre_curso" class="java.lang.String"/>
	<field name="nFaltas" class="java.lang.Integer"/>
	<field name="nota" class="java.math.BigDecimal"/>
	<variable name="promedioNotaCurso" resetType="Group" calculation="Average" resetGroup="GrupoCurso" class="java.math.BigDecimal">
		<expression><![CDATA[$F{nota}]]></expression>
	</variable>
	<variable name="totalFaltasCurso" resetType="Group" calculation="Sum" resetGroup="GrupoCurso" class="java.lang.Integer">
		<expression><![CDATA[$F{nFaltas}]]></expression>
	</variable>
	<variable name="alumnosPorCurso" resetType="Group" calculation="Count" resetGroup="GrupoCurso" class="java.lang.Integer">
		<expression><![CDATA[$F{id_usuario}]]></expression>
	</variable>
	<group name="GrupoCurso">
		<expression><![CDATA[$F{id_curso}]]></expression>
		<groupHeader>
			<band height="35">
				<element kind="staticText" uuid="26a86823-9e8d-4f53-9a1b-a67f505efaf2" mode="Opaque" x="0" y="5" width="60" height="25" backcolor="#81C784" bold="true" vTextAlign="Middle">
					<text><![CDATA[ CURSO:]]></text>
				</element>
				<element kind="textField" uuid="62c80f08-7436-4396-9973-6b38d946577d" mode="Opaque" x="60" y="5" width="495" height="25" backcolor="#81C784" bold="true" vTextAlign="Middle">
					<expression><![CDATA[$F{nombre_curso} + " (ID: " + $F{id_curso} + ")"]]></expression>
				</element>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="30">
				<element kind="staticText" uuid="f95a86e0-1f08-432f-af29-85ab018b3eb0" mode="Opaque" x="0" y="5" width="80" height="20" backcolor="#E8F5E9" bold="true">
					<text><![CDATA[ Alumnos:]]></text>
				</element>
				<element kind="textField" uuid="792af07f-37df-4167-9ea4-8cc302624f34" mode="Opaque" x="80" y="5" width="50" height="20" backcolor="#E8F5E9">
					<expression><![CDATA[$V{alumnosPorCurso}]]></expression>
				</element>
				<element kind="staticText" uuid="3fbe95af-febb-4276-bfe0-ef50c108a317" mode="Opaque" x="130" y="5" width="100" height="20" backcolor="#E8F5E9" bold="true">
					<text><![CDATA[ Nota Promedio:]]></text>
				</element>
				<element kind="textField" uuid="20ab17ff-97b1-4513-b220-9ed69479cb7a" mode="Opaque" x="230" y="5" width="80" height="20" backcolor="#E8F5E9" pattern="#0.00" blankWhenNull="true">
					<expression><![CDATA[$V{promedioNotaCurso}]]></expression>
				</element>
				<element kind="staticText" uuid="5a0966fd-c88a-4979-a1b0-4158ae5756c5" mode="Opaque" x="310" y="5" width="100" height="20" backcolor="#E8F5E9" bold="true">
					<text><![CDATA[ Total Faltas:]]></text>
				</element>
				<element kind="textField" uuid="d3868ff7-2e22-450d-a8c7-02c90099d9e5" mode="Opaque" x="410" y="5" width="145" height="20" backcolor="#E8F5E9" blankWhenNull="true">
					<expression><![CDATA[$V{totalFaltasCurso}]]></expression>
				</element>
			</band>
		</groupFooter>
	</group>
	<title height="70">
		<element kind="staticText" uuid="3bc7b096-6b48-4102-b695-bcabbec7f1cf" x="0" y="10" width="555" height="35" fontSize="22.0" bold="true" hTextAlign="Center">
			<text><![CDATA[MUUDLE - Matriculaciones]]></text>
		</element>
		<element kind="staticText" uuid="38a142bf-0f05-4af2-8f81-0424dac056c2" x="0" y="45" width="300" height="20">
			<text><![CDATA[Informe de alumnos por curso (SQL Compuesta)]]></text>
		</element>
		<element kind="textField" uuid="4c7d0d6a-4ff5-4708-ae2a-072172d77671" x="400" y="45" width="150" height="20" pattern="dd/MM/yyyy HH:mm" hTextAlign="Right">
			<expression><![CDATA[new java.util.Date()]]></expression>
		</element>
	</title>
	<columnHeader height="25">
		<element kind="staticText" uuid="94a13cbe-b407-4b97-b823-73ca74b2d737" mode="Opaque" x="0" y="0" width="120" height="20" backcolor="#2E7D32" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Alumno]]></text>
		</element>
		<element kind="staticText" uuid="7ca422f6-abea-4e9e-b834-2fa1f27010f4" mode="Opaque" x="120" y="0" width="180" height="20" backcolor="#2E7D32" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Email]]></text>
		</element>
		<element kind="staticText" uuid="3f218e90-bb20-40a0-8cf2-9a537bb4bb92" mode="Opaque" x="300" y="0" width="80" height="20" backcolor="#2E7D32" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Rol]]></text>
		</element>
		<element kind="staticText" uuid="ddba1424-cb40-4f83-bce5-67fc72aac988" mode="Opaque" x="380" y="0" width="80" height="20" backcolor="#2E7D32" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Faltas]]></text>
		</element>
		<element kind="staticText" uuid="2bd222b5-7b84-4d5f-8106-3d34434b7d6a" mode="Opaque" x="460" y="0" width="95" height="20" backcolor="#2E7D32" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Nota]]></text>
		</element>
	</columnHeader>
	<detail>
		<band height="20">
			<element kind="textField" uuid="1eff75e0-8df7-464f-9777-512cec394936" x="0" y="0" width="120" height="18" blankWhenNull="true">
				<expression><![CDATA[$F{nombre_usuario} + " " + $F{apellido_usuario}]]></expression>
			</element>
			<element kind="textField" uuid="657cb8ff-a9e2-4d9f-a37c-3f2f7d9d2a01" x="120" y="0" width="180" height="18" blankWhenNull="true">
				<expression><![CDATA[$F{email}]]></expression>
			</element>
			<element kind="textField" uuid="846638f0-d67d-4a36-b222-37297c6fa706" x="300" y="0" width="80" height="18" blankWhenNull="true" hTextAlign="Center">
				<expression><![CDATA[$F{tipo_usuario}]]></expression>
			</element>
			<element kind="textField" uuid="dbbf7c98-97c5-4bae-95b6-6735a989710b" x="380" y="0" width="80" height="18" blankWhenNull="true" hTextAlign="Center">
				<expression><![CDATA[$F{nFaltas}]]></expression>
			</element>
			<element kind="textField" uuid="e34669dc-480a-4888-9f05-8d9be37c1eac" x="460" y="0" width="95" height="18" pattern="#0.00" blankWhenNull="true" hTextAlign="Center">
				<expression><![CDATA[$F{nota}]]></expression>
			</element>
		</band>
	</detail>
	<columnFooter height="10"/>
	<pageFooter height="25">
		<element kind="textField" uuid="83aa388f-643b-4c4a-945a-672195ba4934" x="200" y="5" width="100" height="15" hTextAlign="Right">
			<expression><![CDATA["Pagina " + $V{PAGE_NUMBER}]]></expression>
		</element>
		<element kind="textField" uuid="357b1d56-fa74-4004-aec3-748ceb6c1811" x="300" y="5" width="100" height="15" evaluationTime="Report">
			<expression><![CDATA[" de " + $V{PAGE_NUMBER}]]></expression>
		</element>
	</pageFooter>
</jasperReport>
